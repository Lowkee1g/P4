// Cormen Pseudocode to Python Compiler Dev Container
// For format details, see https://aka.ms/devcontainer.json
{
	"name": "Cormen Pseudocode Compiler",
	"build": {
		"context": "..",
		"dockerfile": "../dockerfile"
	},
	"features": {
		"ghcr.io/devcontainers-contrib/features/ocaml-asdf:2": {},
		"ghcr.io/devcontainers-contrib/features/opam-asdf:2": {}
	},
	
	// Set the workspace folder
	"workspaceFolder": "/workspaces/P4",
	
	// Run commands after the container is created
	"postCreateCommand": "eval $(opam env) && opam install -y dune menhir && find . -name '*.txt' -type f -exec sed -i 's/\r$//' {} \\; && make build",
	
	// Configure VS Code settings and extensions
	"customizations": {
		"vscode": {
			"extensions": [
				"ocamllabs.ocaml-platform",
				"ms-python.python",
				"copilot-codex.copilot-chat"
			],
			"settings": {
				"terminal.integrated.defaultProfile.linux": "bash",
				"files.eol": "\n",
				"files.insertFinalNewline": true,
				"editor.formatOnSave": false
			}
		}
	},
	
	// Use the opam user
	"remoteUser": "opam"
}
